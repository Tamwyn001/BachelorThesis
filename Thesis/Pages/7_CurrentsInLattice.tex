\documentclass[../main.tex]{subfile}
\begin{document}
\subsubsection{Currents}
Using the charge conservation and the Heisenberg picture we are going to derive an expression
for the current in the lattice. The system we are taking into account is two-dimensional.\\

The charge conservation reads
\[
    \partial_t \rho_i = - \nabla \bm{j}_i
\]
and identifies the time variation of the charge density on the site $i$ as the negative divergence of the current density.
Now, performing some transformations, we bring this expression in a more useful form. The goal here is to integrate on both 
side over our two-dimensional surface $\Omega$. For the charge density this yields to the charge at a site:
\[
    \int_{\Omega} \partial_t \rho_i \dd \bm{r} = \partial_t Q_i .
\]
For the current density we can use the Gau√ü law to change the integration set:
\[
    \int_{\Omega} \nabla \bm{j}_i \dd \bm{r} = \int_{\partial \Omega} \bm{j}_i \bm{n} = \sum_{n} J_{i,n} a = \sum_{n} I_{i,n}
\]
where $\partial \Omega$ is the boundary of $\Omega$. The normal vector $\bm{n}$ points in the 2D-plane, outward from the boundary.
Assuming we have a square lattice, we can assign to each lattice site a square
unit cell with side length $a$. The sum over $n$ happens to be over all the side.

Now introducing the Heisenberg picture with $\hbar = 1$ we get
\[
    \partial_t Q_i = \im [H, Q_i].
\]
Finlay we can introduce the second quantization in the charge:
\[
    Q_i = \sum_{\sigma} c_{i\sigma}^{\dagger}  c_{i\sigma} = \sum_{\sigma} n_{i,\sigma}
\]
which is quite trivial, summing over all the particle at a site leads the charge of the site. After putting all together, this yields
\begin{equation}\label{eq:CurrentSidesCommutator}
 I_{i}^{+x} +  I_{i}^{+y} +  I_{i}^{-x} +  I_{i}^{-y} = -\im \left[H, \sum_{\sigma} n_{i,\sigma}\right]
\end{equation}
This mean the last step to perform is to compute the commutator of the different terms of the Hamiltonian with the charge at a site $i$.\\
We remind here, that our Hamiltonian contains a chemical potential, a hopping, a superconducting and an altermagnetic term.

\paragraph{The hopping term} $~$ We use a constant hopping amplitude $t_{ij} = t$.
\[
    \left[ \sum_{\langle ij\rangle\sigma} c_{i\sigma}^{\dagger}c_{j\sigma} , \sum_{\sigma} n_{l\sigma}\right] 
    = \sum_{\langle ij\rangle\sigma\sigma'}  c_{i\sigma}^{\dagger}c_{j\sigma}n_{l\sigma'} - n_{l\sigma'}c_{i\sigma}^{\dagger}c_{j\sigma}
\]
We can then introduce a useful trick that involves the commutator $[n_{\mu},c_{\nu}] = -\delta_{\mu\nu}c_{\mu}$
\begin{equation*}
    \begin{aligned}
    c_{i\sigma}^{\dagger}c_{j\sigma}n_{i,\sigma'} &= c_{i\sigma}^{\dagger} \bigl( \underbrace{c_{j\sigma}n_{l\sigma'} 
    -n_{l\sigma'}c_{j\sigma}}_{-[n_{l\sigma'},c_{j\sigma}]} + n_{l\sigma'}c_{j\sigma}\bigr) \\
    & = c_{i\sigma}^{\dagger} \left(\delta_{\sigma'\sigma}\delta_{lj}c_{i\sigma'} + n_{l\sigma'}c_{j\sigma}\right).
    \end{aligned}
\end{equation*}
Following the same schema we derive the other part of the commutator. Here the expressions involves
$[n_{\mu}, c^{\dagger}_{\nu}] = \delta_{\mu\nu}c^{\dagger}_{\mu}$:
\begin{equation*}
    \begin{aligned}
        n_{l\sigma'}c_{i\sigma}^{\dagger}c_{j\sigma} &= \bigl( \underbrace{n_{l\sigma'}c_{i\sigma}^{\dagger} 
        - c_{i\sigma}^{\dagger}n_{l\sigma'}}_{[n_{l\sigma'}, c^{\dagger}_{i\sigma}]} + c_{i\sigma}^{\dagger}n_{l\sigma'} \bigr)c_{j\sigma} \\
        &= \left(\delta_{\sigma'\sigma}\delta_{li}c_{j\sigma'}^{\dagger} + c_{i\sigma}^{\dagger}n_{l\sigma'} \right)c_{j\sigma}
    \end{aligned}
\end{equation*}
After subtracting the second term from the first one we are left with
\begin{equation*}
    \begin{aligned}
    \left[ \sum_{\langle ij\rangle\sigma} c_{i\sigma}^{\dagger}c_{j\sigma} , \sum_{\sigma} n_{i\sigma}\right] 
    =&\sum_{\langle ij\rangle\sigma\sigma'} \delta_{\sigma'\sigma} \left( \delta_{lj}c_{i\sigma}^{\dagger} c_{j\sigma'} - \delta_{li}c_{i\sigma'}^{\dagger}c_{j\sigma}\right)\\
    =& \frac{1}{2}\sum_{ i \bm{\delta}\sigma\sigma'} \delta_{\sigma'\sigma} \left( \delta_{l,i+ \bm{\delta}}c_{i\sigma}^{\dagger} c_{i+ \bm{\delta},\sigma'} - \delta_{li}c_{i\sigma'}^{\dagger}c_{i+ \bm{\delta},\sigma}\right)
\end{aligned}
\end{equation*}
Because of the squared lattice we can summarize the neighbour set $\langle ij\rangle$ to $\left\{ i + \delta_x , i - \delta_x, i + \delta_y, i - \delta_y   \right\}$ involving
$\delta_{\text{axis}}$ the displacement from the site to neighbour one along the given axis. This is abstracted in $i+ \bm{\delta}$.
We obtain after summing up over the $\sigma'$ and $i$, and writing explicitly everything we obtain 
\begin{equation}\label{Eq:CurrentHoppingCommu}
    \begin{aligned}
        =\frac{1}{2} \sum_{\sigma} 
       &~(c_{l-\delta_x\sigma}^{\dagger}c_{l,\sigma} -c_{l\sigma}^{\dagger}c_{l+\delta_x,\sigma})  
       +(c_{l+\delta_x\sigma}^{\dagger}c_{l,\sigma} -c_{l\sigma}^{\dagger}c_{l-\delta_x,\sigma})\\
       &+(c_{l-\delta_y\sigma}^{\dagger}c_{l,\sigma} -c_{l\sigma}^{\dagger}c_{l+\delta_y,\sigma})
       +(c_{l+\delta_y\sigma}^{\dagger}c_{l,\sigma} -c_{l\sigma}^{\dagger}c_{l-\delta_y,\sigma}),
\end{aligned}
\end{equation}
where the one half factor avoids summing twice over the nearest neighbours. This proportional to the current at a site $l$.
The current of one side of the square unit cell is represented by a pair of $c_{l\pm\delta_x,\sigma}^{\dagger}c_{l\sigma} -c_{l\sigma}^{\dagger}c_{l\pm\delta_x,\sigma}$
where the same displacement $\delta_x$ is involved. This will be an important consideration when coming to the altermagnet.\\

\paragraph{Chemical potential term} For the chemical potential term it is useful to introduce that the commutator between two number operator vanishes. 
Since the charge and the chemical potential operators involves only number operator, we find that this term doesn't take part
to the current.

\paragraph{Superconducting term} The superconducting term has a peculiar behaviour. If one can solve the gap (self consistently), this term 
doesn't contribute to the current as we are going to see. We first form the commutator between the Hubbard term and the charge operator:
\begin{equation*}
        \left[\sum_i\left(\Delta_i c_{i\uparrow}^{\dagger}c_{i\downarrow}^{\dagger} + 
        \Delta_i^{\ast} c_{i\uparrow}c_{i\downarrow}\right) , \sum_{\sigma} n_{l,\sigma}\right]
\end{equation*}
again make the already introduced commutator appear, we obtain
\begin{equation*}
    \begin{aligned}
    &= \sum_{i\sigma} \delta_{il}\left(\Delta_i^{\dagger} (\delta_{\sigma\downarrow} + \delta_{\sigma\uparrow})c_{i\downarrow}c_{i\uparrow} 
    -\Delta_i(\delta_{\sigma\downarrow} + \delta_{\sigma\uparrow})c_{i\uparrow}^{\dagger} c_{i\downarrow}^{\dagger}\right)\\
    &= 2 \left( \Delta_i^{\dagger} c_{l\downarrow}c_{l\uparrow} - \Delta_i c_{l\uparrow}^{\dagger}c_{l\downarrow}^{\dagger}\right)
    \end{aligned}
\end{equation*}
This expression mixes creation and annihilation operators and makes it hard to recognize a current. One can view this term as a 
source \rem{need citation?}meaning we have a new term $\mathcal{C}_i$ that appears in the equation  
\[
    -\partial_t Q_i = \mathcal{C}_i +  \sum_n I_{i,n}  .
\]
To know the contribution to the current we can investigate the rate of charge generation of this term. This is achieved by taking the quantum
expectation and the thermal average of the system.
\[
    2 \left( \Delta_l^{\dagger}\langle c_{l\downarrow}c_{l\uparrow}\rangle - \Delta_l \langle c_{l\uparrow}^{\dagger}c_{l\downarrow}^{\dagger}\rangle\right)
    = \frac{2}{U_l}\left(-\Delta_l^{\dagger}\Delta_l + \Delta_l \Delta_l^{\dagger}\right)
\]
This is achieved using the anticommutation relation of the fermionic operators Eq.\ref{eq:Fermion1} and Eq.\ref{eq:Fermion2}. 
We have as well $\Delta_l^{\dagger} = U_i^{\ast} \langle(c_{l\uparrow}c_{l\downarrow})^{\dagger}\rangle = U_i \langle c_{l\downarrow}^{\dagger} c_{l\uparrow}^{\dagger}\rangle$.
The dagger operator is assumed to be inserted into the expectation value using the linearity of the integral defining $\langle \cdot\rangle$.

Solving $\Delta$ self-consistently will lead to $\Delta\Delta^{\dagger} = \Delta^{\dagger}\Delta$, and therefore we find that the value vanishes.

\paragraph{Altermagnetic term}
As we introduced it in a previous discussion, the altermagnetic term is more complicated than the last one treated and need more work. In essence, we describe an 
advanced hopping term, that changes regarding of the hopping axis.
We can first bring the commutator where the matrix element $\bigl(\bm{m}_{ij}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'} $ is a scalar:
\begin{equation*}
    \begin{aligned}
    \left[\sum_{\langle i j \rangle\sigma\sigma'}\bigl(\bm{m}_{ij}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'} 
         \cdot c_{i\sigma}^{\dagger}c_{j\sigma'}, \sum_{\tilde{\sigma}} n_{l,\tilde{\sigma}}\right] 
        =&\sum_{\substack{\langle i j \rangle \\\sigma\sigma'\tilde{\sigma}}} 
         \bigl(\bm{m}_{ij}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}  \left(c_{i\sigma}^{\dagger}c_{j\sigma'}n_{l\tilde{\sigma}} 
        -n_{l\tilde{\sigma}}c_{i\sigma}^{\dagger}c_{j\sigma'} \right)\\
        = &\sum_{\substack{\langle i j \rangle \\\sigma\sigma'\tilde{\sigma}}}  \bigl(\bm{m}_{ij}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}  
         \delta_{\sigma\tilde{\sigma}} \left(\delta_{lj}c_{i\sigma}^{\dagger}c_{j\tilde{\sigma}} - \delta_{li}c_{i\tilde{\sigma}}^{\dagger}c_{j\sigma'}\right)\\
        = &\frac{1}{2}\sum_{\substack{ i \bm{\delta}\sigma\sigma'}}  \bigl(\bm{m}_{i,i+\bm{\delta}}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}  
         \left(\delta_{l,i+\bm{\delta}}c_{i\sigma}^{\dagger}c_{i+\bm{\delta},\sigma} - \delta_{li}c_{i\sigma}^{\dagger}c_{i+\bm{\delta},\sigma'}\right)
    \end{aligned}
\end{equation*}
Using the same transformation we made earlier to introduce the commutator between $n,c$ and $n,c^{\dagger}$ we obtain after summing over the $\tilde{\sigma}$
introducing a new set made of  $\bm{\delta}$s as we did before. The summation over the $\bm{\delta}$ results in the following cumbersome expression
\begin{equation}\label{eq:CurrentAltermagCommu}
    \begin{aligned}
        = \sum_{\sigma}\Biggl[&
                \sum_{\sigma'}\bigl(\bm{m}_{l,l+\delta_x}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}
                \left(c_{l-\delta_x,\sigma}^{\dagger}c_{l\sigma} - c_{l\sigma}^{\dagger}c_{l+\delta_x,\sigma'} \right) \\
                +&\sum_{\sigma'}\bigl(\bm{m}_{l,l-\delta_x}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}
                \left(c_{l+\delta_x,\sigma}^{\dagger}c_{l\sigma} - c_{l\sigma}^{\dagger}c_{l-\delta_x,\sigma'} \right) \\
                +&\sum_{\sigma'}\bigl(\bm{m}_{l,l+\delta_y}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}
                \left(c_{l-\delta_y,\sigma}^{\dagger}c_{l\sigma} - c_{l\sigma}^{\dagger}c_{l+\delta_y,\sigma'} \right) \\
                +& \sum_{\sigma'}\bigl(\bm{m}_{l,l-\delta_y}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}
                \left.\left(c_{l+\delta_y,\sigma}^{\dagger}c_{l\sigma} - c_{l\sigma}^{\dagger}c_{l-\delta_y,\sigma'} \right) \right]
    \end{aligned}
\end{equation} 
When it will come to identify the current on each side of the unit cell, we will have to take into account the displacement $\delta$ that is involved in the 
$c_{l\pm\delta_x,\sigma}^{\dagger}c_{l\sigma} -c_{l\sigma}^{\dagger}c_{l\pm\delta_x,\sigma'}$.
This has to be consistent with what we already did for the hopping term. This means each current flowing throught one side will be dependent on the spin hopping on both direction 
of the side's axis. No worries, will become clear in the derivation.\\

\paragraph{Side currents}
Each unit cell were introduced as a square. We can from the last derived equation identify the contribution of the current on each side of the cell. We have a side on 
each axis direction $+x, +y, -x, -y$ as introduced in Eq.\ref{eq:CurrentSidesCommutator}. Due to the symmetric properties of the current, we can abstract the notation
for $r\in\{x,y\}$. Using Eq.\ref{Eq:CurrentHoppingCommu} and Eq.\ref{eq:CurrentAltermagCommu} we can write the current on each side $r$ as follows.
We as well reintroduce the minus of every summand of the Hamiltonian (due to their attractive nature) we let aside for the commutator relations. This multiplies 
with the minus one from the Heisenberg picture resulting in a plus sign. Further, taking $\im = -1/\im$ we get:
\begin{align}
    \left(I_{i}^{\pm r}\right)_{hop} &= -\frac{t}{2\im}\sum_{\sigma}c_{i\pm\delta_r,\sigma}^{\dagger}c_{i\sigma} -c_{i\sigma}^{\dagger}c_{i\pm\delta_r,\sigma}  \\
    \left(I_{i}^{\pm r}\right)_{AM} &=  -\frac{1}{2\im}\sum_{\sigma\sigma'}c_{i\pm\delta_r,\sigma}^{\dagger}c_{i\sigma}\bigl(\bm{m}_{i,i\mp\delta_r}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'} - c_{i\sigma}^{\dagger}c_{i\pm\delta_r,\sigma'}\bigl(\bm{m}_{i,i\pm\delta_r}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'} 
\end{align}
In this sense the hopping and altermagnetic term are very similar from nature. However, the altermagnetic term is scaled by the hopping amplitude $t$ on each summand, 
which shows a spin-dependent behaviour.\\

We're not quite finished. The way we defined the matrix element, is to be isotropic on each axis. By doing so we can 
assume that $\bigl(\bm{m}_{i,i-\delta_r}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'} = \bigl(\bm{m}_{i,i+\delta_r}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}$ so that:
\begin{equation}
    \left(I_{i}^{\pm r}\right)_{AM} =  -\frac{1}{2\im}\sum_{\sigma\sigma'}\bigl(\bm{m}_{i,i+\delta_r}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}\left(c_{i\pm\delta_r,\sigma}^{\dagger}c_{i\sigma} - c_{i\sigma}^{\dagger}c_{i\pm\delta_r,\sigma'}\right).
\end{equation}

\paragraph{Total currents}
Until now, we are able to describe how the current flows through each faces of the unit cell. For this we can simply split the term we derived.
From this we now aim to derive the current flows on each axis.
This can easily be done assuming that the current flowing in the $-x$ direction subtracted from the current in the positive $x$ direction forms the total current in $\bm{e}_x$.
From this we get for $r\in\{x,y\}$:
\[
    I_{i}^{r} = I_{i}^{+r} - I_{i}^{-r}.
\]
The real current that we can measure can be obtained by taking the quantum expectation value and the thermal average of the currents. Further we also introduce the 
BdG-transformed operators with the eigenvalues \ref{eq:BdG_transf_c} and \ref{eq:BdG_transf_c_dagg}. \\

For the seek of readability we are going to stick with this $r$-notation. In fact the total currents takes a disproportionate size on the page, so we abstract a bit.
Further, due to the linearity of the commutator one can split the current in different terms. We first start with the derivation of the physical current
that comes from the hopping term.
\begin{equation*}
    \begin{aligned}
    \langle I_i^r\rangle_{\text{hop}} = \frac{t}{2\im}\left[ \sum_{\sigma} 
        \langle c_{i-\delta_{r},\sigma}^{\dagger} c_{i\sigma}\rangle
        -\langle c_{i\sigma}^{\dagger}            c_{i-\delta_{r},\sigma}\rangle
        -\langle c_{i+\delta_{r},\sigma}^{\dagger} c_{i\sigma}\rangle
        +\langle c_{i\sigma}^{\dagger}            c_{i+\delta_{r},\sigma}\rangle\right]
\end{aligned}
\end{equation*}
and after introducing the BdG-transformed operators we obtain for the first term:
\begin{equation*}
    \begin{aligned}
        \color{TamGreen}{\langle c_{i-\delta_r,\sigma}^{\dagger} c_{i\sigma}\rangle} \color{black}= \sum_{n,m\in\mathcal{N}_+} 
        &u_{n,i-\delta_r,\sigma}^{\ast} u_{ni\sigma} \underbrace{\langle \gamma_n^{\dagger}\gamma_m\rangle}_{\delta_{mn}f(E_n)} 
        +~ u_{n,i-\delta_r,\sigma}^{\ast} v_{mi\sigma}^{\ast} \underbrace{\langle \gamma_n^{\dagger}\gamma_m^{\dagger}\rangle}_{0}\\
        +~& v_{n,i-\delta_r,\sigma}u_{mi\sigma}\underbrace{\langle \gamma_n\gamma_m\rangle}_{0}
        +~ v_{n,i-\delta_r,\sigma}v_{mi\sigma}^{\ast}\underbrace{\langle \gamma_n\gamma_m^{\dagger}\rangle}_{\delta_{mn}\bigl(1-f(E_n)\bigr)}.
    \end{aligned}
\end{equation*}
In the same way, we obtain for the other terms:
\begin{alignat*}{2}
    -\color{TamGreen}{\langle c_{i\sigma}^{\dagger}c_{i-\delta_{r},\sigma}\rangle} &= -&\sum_{n\in\mathcal{N}_+} u_{ni\sigma}^{\ast}u_{n,i-\delta_r,\sigma} f(E_n) + v_{ni\sigma}v_{n,i-\delta_r,\sigma}^{\ast}\bigl(1-f(E_n)\bigr),\\
    -\color{TamTangerine}{\langle c_{i+\delta_{r},\sigma}^{\dagger}c_{i\sigma}\rangle} &= -&\sum_{n\in\mathcal{N}_+} u_{n,i+\delta_r,\sigma}^{\ast}u_{ni\sigma} f(E_n) + v_{n,i+\delta_r,\sigma}v_{ni\sigma}^{\ast}\bigl(1-f(E_n)\bigr),\\
    \color{TamTangerine}{\langle c_{i\sigma}^{\dagger}c_{i+\delta_{r},\sigma}\rangle} &=  &~\sum_{n\in\mathcal{N}_+} u_{ni\sigma}^{\ast}u_{n,i+\delta_r,\sigma} f(E_n) + v_{ni\sigma}v_{n,i+\delta_r,\sigma}^{\ast}\bigl(1-f(E_n)\bigr).
\end{alignat*}
Here we can recognize a very useful relation that is going to simplify everything. We have $\langle c_{i\pm\delta_r,\sigma}^{\dagger} c_{i\sigma}\rangle = \langle c_{i\sigma}^{\dagger}c_{i\pm\delta_{r},\sigma} \rangle^{\ast}$.
We can then recall a useful relation that we can use in these expressions. Having $z$ a complex we obtain $\mathcal{I}\text{m}(z) = \frac{1}{2\im}(z-z^{\ast})$. Further $\mathcal{I}\text{m}(z)+\mathcal{I}\text{m}(z') = \mathcal{I}\text{m}(z+z')$.
After summing up the terms we obtain the following expression for current of the hopping term along the axis $r$:

\begin{equation}
    \begin{aligned}
        \langle I_i^r\rangle_{\text{hop}} = t\cdot\mathcal{I}\text{m}\biggl[ \sum_{\sigma}\sum_{n\in\mathcal{N}_+} 
            f(E_n)u_{ni\sigma}\left(u_{n,i-\delta_r,\sigma}^{\ast} - u_{n,i+\delta_r,\sigma}^{\ast}\right) &\\
            +\bigl(1-f(E_n)\bigr) v_{ni\sigma}^{\ast}\left(v_{n,i-\delta_r} - v_{n,i+\delta_r,\sigma}\right)&\biggr].
    \end{aligned}
\end{equation}
And inside the altermagnet we add the following term using the same derivation method. The matrix element $\bigl(\bm{m}_{i,i+\delta_r}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}$ is a constant regarding
the states-brakets. In this sense, the quantum expectation and thermal average leave this quantity unchanged. Finally, we obtain the exact
same result than a $t$ hopping but with a prefactor. This is consistent with the observation already made.
\begin{equation*}
    \begin{aligned}
    \langle I_i^r\rangle_{\text{AM}} = \frac{1}{2\im}\sum_{\sigma\sigma'}\bigl(\bm{m}_{i,i+\delta_r}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}\left[
        \langle c_{i-\delta_{r},\sigma}^{\dagger} c_{i\sigma}\rangle
        -\langle c_{i\sigma}^{\dagger}            c_{i-\delta_{r},\sigma'}\rangle
        -\langle c_{i+\delta_{r},\sigma}^{\dagger} c_{i\sigma}\rangle
        +\langle c_{i\sigma}^{\dagger}            c_{i+\delta_{r},\sigma'}\rangle\right]
\end{aligned}
\end{equation*}
which after using the same derivation method as before yields:
\begin{equation}
    \begin{aligned}
        \langle I_i^r\rangle_{\text{AM}} = \frac{1}{2\im}\biggl[ \sum_{\sigma\sigma'}\bigl(\bm{m}_{i,i+\delta_r}\cdot\bm{\sigma}\bigr)_{\sigma\sigma'}\\
\sum_{n\in\mathcal{N}_+}~~~~~~~~~~~ f(E_n)                &\left[u_{ni\sigma}       \bigl(u_{n,i-\delta_r,\sigma}^{\ast} - u_{n,i+\delta_r,\sigma}^{\ast}\bigr) + u_{ni\sigma}^{\ast}\bigl(u_{n,i+\delta_r,\sigma'}        - u_{n,i-\delta_r,\sigma'}       \bigr)\right]\\
                         +\bigl(1-f(E_n)\bigr) &\left[v_{ni\sigma}^{\ast}\bigl(v_{n,i-\delta_r,\sigma}        - v_{n,i+\delta_r,\sigma}       \bigr) + v_{ni\sigma}       \bigl(v_{n,i+\delta_r,\sigma'}^{\ast} - v_{n,i-\delta_r,\sigma'}^{\ast}\bigr)\right]\biggr].\\
    \end{aligned}
\end{equation}

\end{document}